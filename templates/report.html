{# templates/report.html #}

<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Shodan2DB</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
</head>
<body class="has-navbar-fixed-top">
<div class="container is-fluid">
    <div class="has-text-centered is-size-1">
        Surface exposure report
    </div>
    <br>
    <nav class="navbar is-fixed-top is-transparent mx-4">
        <div class="navbar-brand">
            <a class="navbar-item has-text-weight-semibold" href="#top">
                Shodan2DB
            </a>
        </div>
        <div class="navbar-menu">
            <div class="navbar-start">
                <a class="navbar-item" href="#vulns-list">Vulnerabilities</a>
                <a class="navbar-item" href="#cve-list">CVE list</a>
            </div>
        </div>
    </nav>
    <nav id="vulns-list" class="level">
        <div class="level-item has-text-centered">
            <div>
                <p class="heading">Hosts</p>
                <p class="title">{{ hosts |length }}</p>
            </div>
        </div>
        <div class="level-item has-text-centered">
            <div>
                <p class="heading">Vulnerabilities</p>
                <p class="title">{{ vulns |length }}</p>
            </div>
        </div>
        <div class="level-item has-text-centered">
            <div>
                <p class="heading">Products</p>
                <p class="title">{{ services |length }}</p>
            </div>
        </div>
        <div class="level-item has-text-centered">
            <div>
                <p class="heading">CVE</p>
                <p class="title">{{ cves |length }}</p>
            </div>
        </div>
    </nav>
    {% for host in hosts %}
    <div class="tile is-parent">
        <article class="tile is-child notification is-info">
            <p><a href="https://www.shodan.io/host/{{ host.ip }}" class="title">{{ host.ip }}</a> <span
                    class="tag is-rounded is-large">{{ host.nbvulns }}</span></p>
            <p class="subtitle">{{ host.hostnames }}</p>
            <div class="content">
                <p>
                    <b>ISP</b> : {{ host.isp }}
                    <br><b>City</b> : {{ host.city }}
                    {% if host.tags %}
                    <br><b>Tags</b> : {{ host.tags }}
                    {% endif %}
                </p>
            </div>
        </article>
    </div>
    <table class="table is-hoverable is-bordered">
        <thead>
        <tr>
            <th>Product</th>
            <th>Version</th>
            <th>Port</th>
            <th>Transport</th>
        </tr>
        </thead>
        <tbody>
        {% for service in services %}
        {% if service.ip == host.ip %}
        <tr>
            <td>{{ service.product }}</td>
            <td>{{ service.version }}</td>
            <td><a href="https://www.shodan.io/host/{{ host.ip }}#{{ service.port }}">{{ service.port }}</a>
            </td>
            <td>{{ service.transport }}</td>
        </tr>
        {% endif %}
        {% endfor %}
        </tbody>
    </table>
    <table class="table is-hoverable is-bordered">
        <thead>
        <tr>
            <th>CVE</th>
            <th>CVSS</th>
            <th>Description</th>
        </tr>
        </thead>
        <tbody>
        {% for vuln in vulns %}
        {% if vuln.ip == host.ip %}
        <tr>
            <td>{{ vuln.cveid }}</td>
            <td>{{ vuln.cvss }}</td>
            <td>{{ vuln.summary }}</td>
        </tr>
        {% endif %}
        {% endfor %}
        </tbody>
    </table>
    {% endfor %}

    <p id="cve-list" class="title is-3 is-spaced">Security vulnerability (CVE) list</p>
    <table class="table is-hoverable is-bordered">
        <thead>
        <tr>
            <th>CVE</th>
            <th>Count</th>
            <th>CVSS</th>
            <th>Description</th>
        </tr>
        </thead>
        <tbody>
        {% for cve in cves %}
        <tr>
            <td>{{ cve.cveid }}</td>
            <td>{{ cve.count }}</td>
            <td>{{ cve.cvss }}</td>
            <td>{{ cve.summary }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
</body>
</html>